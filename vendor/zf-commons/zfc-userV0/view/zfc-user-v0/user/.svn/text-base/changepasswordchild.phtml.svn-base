
<style>#dropdown_flag_customsd{display:block;float:left}#phonecode_msdd{width:110px!important}.dd .ddTitle .ddTitleText{padding-left:5px;padding-top:3px}</style>
<div class="main-containter">
	<div class="sub-containter">
		<?php echo $this->partial('zfc-user/user/profile-menu.phtml',array('page'=>'mychild','addedmentors'=>$addedMentors,'addedStudents' => $addedStudents));?>
		<div class="clearfix"></div>
		<table cellpadding="0" cellspacing="0" width="100%" class="container-content">
			<tbody>
				<tr>
					<?php   // $this->partial('account/account/account-menu-common.phtml',array('boardname'=>$this->user->board_name,'board_id'=>$this->user->board_id,'classname'=>$this->user->class_name,'class_id'=>$this->user->class_id));?>
					<td class="right-td">
						<div class="right-content" style="padding-left:0px;">
							<input type="hidden" value="nav_1" id="nav_find">
								<form action="" name="login" id="login" method="post" style="width:auto;padding: 0; margin-bottom:0px;">
			
                <div class="log-fld" style="border-bottom:0px;">
				<div style="height:25px;"><span class="valid-error" id="confirmerrormsg" style="position:inherit; padding-left:160px;"></span>
					<span class="valid-error greencolor" id="successmesg" style="color:#008000; position:inherit; padding-left:160px;"></span></div>
                    <div class="log-bx">
                        <?php if(isset($this->username) && $this->username!=''){ ?>
                        <div class="changepass_lftbx">User Name</div>
							<div style=" float: left; height: 60px; width: 64.4%;">
							<div style="padding-top:10px; color:#333; font-size:16px;"><?php echo $this->username;?></div>
							</div>
                        <?php }?>
                        <div class="clearfix"></div>
						<?php if(isset($_GET['token'])){?>
							<div class="changepass_lftbx">Old Password<span>*</span></div>
							<div class="changepass_rhtbx">
								<input type="password" value="" name="oldpwd" id="oldpwd" placeholder="Enter your old password" onkeypress="changeSubmit(event)">
							</div>
							<span style="color:red;width:60%; margin-left:35%; float:left; margin-top:-20px; margin-bottom:10px;">(You got a password in your email)</span>
						<?php }else if(1){
                                                }else{?>
							<div class="changepass_lftbx">Old Password<span>*</span></div>
							<div class="changepass_rhtbx">
                            <input type="password" value="" name="oldpwd" id="oldpwd" placeholder="Enter your old password" onkeypress="changeSubmit(event)">
                        </div>
						<?php }?>                        
                        <div class="clearfix"></div>
						<div class="changepass_lftbx">New Password<span>*</span></div>
                        <div class="changepass_rhtbx">
                            <input 
                               <?php if(1){?>
                                  type ="text"
                               <?php }else{?>
                                   type="password" 
                               <?php }?>
                                value="" name="newpwd" id="newpwd" onkeypress="changeSubmit(event)" placeholder="Enter New Password">
                        </div><div class="clearfix"></div>
						<div class="changepass_lftbx">Confirm Password<span>*</span></div>
                        <div class="changepass_rhtbx">
                            <input
                                 <?php if(1){?>
                                  type ="text"
                               <?php }else{?>
                                   type="password" 
                               <?php }?>
                                value="" name="confirm-pwd" id="confirm-pwd" onkeypress="changeSubmit(event)" placeholder="Re-enter New password">
                        </div>						
                    </div>
					
                    <div class="reset-pswd-btn" style="margin-bottom:5px;">
	                    <a id="hide_onclick" href="javascript:void(0);" onClick="return changePassword();">
						<img id="hide_change" src="<?php echo $this->basePath() ?>/images/Home-Login_Forgot_Password/button_reset.png" class="logbt"></a>
   					</div>					
					<div class="clearfix"></div>
			    </div>
				<?php if(isset($_GET['id']) && $_GET['id']!=""){
						$id=$_GET['id'];						
				}else if(isset($_GET['userId']) && $_GET['userId']!=""){
					$id=$_GET['userId'];					 
				}?>
				<input type="hidden" id="userid" name="userid" value="<?php echo $id;?>">
            </form>                       
					</div>
				  </td>
				</tr>
			</tbody>
		</table>
	</div>
</div>


<script type="text/javascript" language="JavaScript">
document.forms['login'].elements['oldpwd'].focus();
function changeSubmit(e) {	
	if(e.keyCode == 13) {
		return changePassword();
	}
}
$('input,textarea').placeholder();
</script>
<script>
	function changePassword(){
		var flag=true;
		<?php 
                $url=$this->URL('myChild');	
                if(isset($_GET['id']) && $_GET['id']!=""){
				$url=$this->URL('home');						
			}else if(isset($_GET['userId']) && $_GET['userId']!=""){
				$url=$this->URL('my-profile');					 
		}?>
		var userId=$("#userid").val();
		var oldpasswrd=$("#oldpwd").val();               
		var passwrd=$("#newpwd").val();
		var cnfpwrd=$("#confirm-pwd").val();	
		if(cnfpwrd==""){
			$("#confirmerrormsg").css('display','block');
			$("#confirmerrormsg").html('All (*) fields are mandatory');
			flag=false;
			$("#newpwd").focus();
		}
		if(passwrd==""){
			$("#confirmerrormsg").css('display','block');
			$("#confirmerrormsg").html('Please enter your new password!');
			flag=false;
			$("#newpwd").focus();
		}
		if(passwrd!=""){
			if(passwrd.length<=5){
				$("#confirmerrormsg").css('display','block');
				$("#confirmerrormsg").html('The password should be of minimum 6 characters.');
				flag=false;
				$("#newpwd").focus();
			}
		}  
		if(oldpasswrd==passwrd){
			$("#confirmerrormsg").css('display','block');
			$("#confirmerrormsg").html('New password should not be same as the old password.');
			flag=false;
			$("#newpwd").focus();
		}
                
                if(oldpasswrd!='undefined'){
		if(oldpasswrd==""){
			$("#confirmerrormsg").css('display','block');
			$("#confirmerrormsg").html('Please enter your old password!');
			flag=false;
			$("#oldpwd").focus();
                    }
                }
		if(flag==false){ 
				return false;
		}else{                    
                         <?php if(1){?>
                                 if (passwrd==cnfpwrd){
                                  $.ajax({
								type:'POST',
								url:   BASE_URL+'/user/changepasswordchild',
								data:{cnfpwrd:cnfpwrd,userId:userId},
								success: function(data){
									$("#confirmerrormsg").css('display','none');
									$("#successmesg").css('display','block');
									$("#successmesg").html('Child password has been changed.');
									window.location='<?php echo $url;?>';
								}
							});
                                           }else{
                                           $("#confirmerrormsg").css('display','block');
                                            $("#confirmerrormsg").html('Child new password and confirm password do not match!');
                                            $("#confirm-pwd").focus();
                                           }
                           <?php }else{?>      
                         if (passwrd==cnfpwrd){
                                        $.ajax({
					type:'POST',
					url:  BASE_URL+'/user/check-password',
					data:{oldpasswrd:oldpasswrd,userId:userId},
					success: function(data){						
						if(data.output=='success'){	
                                                		
                                                            $.ajax({
								type:'POST',
								url:   BASE_URL+'/user/change-password',
								data:{cnfpwrd:cnfpwrd,userId:userId},
								success: function(data){
									$("#confirmerrormsg").css('display','none');
									$("#successmesg").css('display','block');
									$("#successmesg").html('Password Changed Successfully');
									window.location='<?php echo $url;?>';
								}
							});					
						}else{
							$("#confirmerrormsg").css('display','block');
							$("#confirmerrormsg").html('Please type your correct old password');
						}
					}
				});
                                
                             }else{
				$("#confirmerrormsg").css('display','block');
				$("#confirmerrormsg").html('your new password and confirm password do not match!');
				$("#confirm-pwd").focus();
			   }
                        <?php }?>
                        
		}
	}	
</script>