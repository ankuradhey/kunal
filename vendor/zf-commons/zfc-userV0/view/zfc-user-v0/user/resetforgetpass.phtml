<link href="<?php echo $this->basePath("/css/website/profile.css"); ?>" rel="stylesheet">
<style>#dropdown_flag_customsd{display:block;float:left}#phonecode_msdd{width:110px!important}.dd .ddTitle .ddTitleText{padding-left:5px;padding-top:3px}</style>



<div id="content" class="profile-pages">
    <div class="container">
        <div class="row">
            <div class="myprofile-content">
                <div class="profile-view globle-click clearfix">
                    <strong>My Profile</strong>
                        <i class="icons-ar"></i>	
                </div>
     <div class="log-fld" style="border-bottom:0px;">
				<div style="height:25px;"><span class="valid-error" id="confirmerrormsg" style="position:inherit; padding-left:160px;"></span>
			<!--span class="greencolor" id="suggmsg" style="color:#008000; position:inherit; padding-left:160px;">  <?//php echo $this->msg;?></span></div-->
        <section class="profile-block">
            <?php if($this->activelink==1){ ?> 
            <input type="hidden" value="nav_1" id="nav_find">
                <div class="changePassword" >
                   <form name="resetpass" class="form-horizontal"  id="resetpass" method="POST" action="<?php echo $this->Url('zfcuser/resetforgetpass');?>">
		
                  <div class="form-group clearfix">
                <label class="col-sm-2 control-label" for="usernameLogin">New Password<sup>*</sup></label>
                <div class="col-sm-4"><input type="password" class="form-control" value="" name="newpwd" id="newpwd" onkeypress="changeSubmit(event)" placeholder="Enter your New Password"></div>
                  </div>
                       
                       <div class="form-group clearfix">
                <label class="col-sm-2 control-label" for="usernameLogin">Confirm Password<sup>*</sup></label>
                <div class="col-sm-4"> <input type="password" value="" class="form-control" name="confirm-pwd" id="confirm-pwd" onkeypress="changeSubmit(event)" placeholder="Re-enter your New password"></div>
                  </div>
 
		 <input type="hidden" id="userid" name="userid" value="<?php echo $this->userid;?>">
                <input type="hidden" id="tokenid" name="tokenid" value="<?php echo $this->tokenid;?>">
                    
                    
                    <div class="form-group clearfix">
		    <label for="vpass" class="col-sm-2 control-label">&nbsp;</label>
		    <div class="col-sm-4">
                  <a id="hide_onclick" class="btn btn-primary" href="javascript:void(0);" onClick="return resetNewPassword();">RESET PASSWORD</a>
		    </div>
                    
                    
					
                    </div>
				
            </form>                     
					
				 

        </div>
            <?php } else {
                    
                    if($this->output == 'success'){
                    ?>
                    <div style="margin: 10px;"> <span class="greencolor" id="suggmsg" style="color:#008000; position:inherit; padding-left:180px;font-size:20px;">  <?php echo $this->msg;?></span></div>
                 <?php                 
                    }else if($this->output == 'failed'){
                    ?>
                    <div style="margin: 10px;"> <span class="greencolor" id="suggmsg" style="color:red !important; position:inherit; padding-left:180px;font-size:20px;">  <?php echo $this->msg;?></span></div>
                 <?php                 
                    }
                 
                 } ?>
          </section>
                </div>
</div>
 </div>
</div>






<script type="text/javascript" language="JavaScript">

function changeSubmit(e) {	
	
}
$('input,textarea').placeholder();
</script>
<script>
	function resetNewPassword(){		
		var flag=true;
		
		var userId=$("#userid").val();
		           
		var passwrd=$("#newpwd").val();
		var cnfpwrd=$("#confirm-pwd").val();
                $('#suggmsg').html('');
                 if (passwrd!==cnfpwrd){
                     $("#confirmerrormsg").css('display','block');
                    $("#confirmerrormsg").html('your new password and confirm password do not match!');
                    $("#confirm-pwd").focus();
                    flag=false;
                 }
		if(cnfpwrd==""){
			$("#confirmerrormsg").css('display','block');
			$("#confirmerrormsg").html('Please enter confirm password!');
			flag=false;
			$("#newpwd").focus();
		}
		if(passwrd==""){
			$("#confirmerrormsg").css('display','block');
			$("#confirmerrormsg").html('Please enter your new password!');
			flag=false;
			$("#newpwd").focus();
		}
		if(passwrd!=""){
			if(passwrd.length<=5){
				$("#confirmerrormsg").css('display','block');
				$("#confirmerrormsg").html('Password length should be minimum of six characters!');
				flag=false;
				$("#newpwd").focus();
			}
		} 
                
	
		if(flag==false){ 
				return false;
		}else{                    
                     //$('#resetpass').submit();    
                       var formdata = $("#resetpass").serialize();
                        $.ajax({
                            type: 'POST',
                            url: '<?php echo $this->basePath(); ?>' + "/user/forgetpassvalidate",
                            dataType: 'json',
                            data: formdata,
                            success: function(data) {
                                $("#confirmerrormsg").css('display','block');
                                $('#confirmerrormsg').html('');
                                /*setTimeout(function() {
                                    $('#confirmerrormsg').html('');
                                    $("#confirmerrormsg").css('display','none');
                                }, 5000);*/
                                if(data.response == 'required') {
                                    $('#confirmerrormsg').html('All Fields are required');
                                } else if(data.response == 'match') {
                                    $('#confirmerrormsg').html('The new password and confirmation password do not match. Please try again!');
                                } else if(data.response == 'length') {
                                    $('#confirmerrormsg').html('Password length should be minimum of six characters!');
                                } else if(data.response == 'space') {
                                    $('#confirmerrormsg').html('Password should not have blank spaces!');
                                } else if(data.response == 'special') {
                                    $('#confirmerrormsg').html('Password should not have junk characters. Allowed Special Characters are ! @ ; , $ # & ( ) + : . _');
                                } else if(data.response == 'failed') {
                                    $('#confirmerrormsg').html('Password reset failed!');
                                } else if(data.status == false) {
                                    $('#confirmerrormsg').html('Password reset failed!');
                                } else if(data.status == true) {
                                    $('#resetpass').submit();
                                }
                            }
                        });	
                    }
	}	
</script>